# –û—Ç—á–µ—Ç –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è "–¢–µ–º–∞ #22. CRUD –∏ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏"

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#1-–æ–±—â–µ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
2. [–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π](#2-–æ–ø–∏—Å–∞–Ω–∏–µ-—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö-crud-–æ–ø–µ—Ä–∞—Ü–∏–π)
3. [–û–ø–∏—Å–∞–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π](#3-–æ–ø–∏—Å–∞–Ω–∏–µ-–∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö-—Ñ—É–Ω–∫—Ü–∏–π)
4. [–ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Django ORM](#4-–ø–æ—è—Å–Ω–µ–Ω–∏—è-–∫-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é-django-orm)
5. [–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤](#5-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–∑–∞–ø—Ä–æ—Å–æ–≤)
6. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#6-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
7. [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é](#7-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏-–ø–æ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é)

---

## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1.1. –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä CRUD –æ–ø–µ—Ä–∞—Ü–∏–π (Create, Read, Update, Delete) –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `books` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Django ORM, —Ñ–æ—Ä–º –∏ —à–∞–±–ª–æ–Ω–æ–≤. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

### 1.2. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

–î–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `books` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ–ª–Ω—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏:

- **Book** (–ö–Ω–∏–≥–∏) - –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å —Å ForeignKey –Ω–∞ Publisher –∏ ManyToMany –Ω–∞ Store
- **Publisher** (–ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞) - –º–æ–¥–µ–ª—å –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤
- **Store** (–ú–∞–≥–∞–∑–∏–Ω—ã) - –º–æ–¥–µ–ª—å –∫–Ω–∏–∂–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
- **Review** (–û—Ç–∑—ã–≤—ã) - –º–æ–¥–µ–ª—å –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –∫–Ω–∏–≥–∏ —Å ForeignKey –Ω–∞ Book

### 1.3. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **–§–æ—Ä–º—ã** (`books/forms.py`) - —Ñ–æ—Ä–º—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
2. **–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è** (`books/views.py`) - —Ñ—É–Ω–∫—Ü–∏–∏-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–ú–∞—Ä—à—Ä—É—Ç—ã** (`books/urls.py`) - URL-–º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–®–∞–±–ª–æ–Ω—ã** (`templates/books/`) - HTML-—à–∞–±–ª–æ–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
5. **–°—Ç–∏–ª–∏** (`static/books/css/styles.css`) - CSS —Å—Ç–∏–ª–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

---

## 2. –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π

### 2.1. CRUD –¥–ª—è –º–æ–¥–µ–ª–∏ Book (–ö–Ω–∏–≥–∏)

#### 2.1.1. Create (–°–æ–∑–¥–∞–Ω–∏–µ)

**–§—É–Ω–∫—Ü–∏—è:** `book_create(request)`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–æ—Ä–º—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∫–Ω–∏–≥–∏
- –ü–æ–ª—è —Ñ–æ—Ä–º—ã: –Ω–∞–∑–≤–∞–Ω–∏–µ, –∞–≤—Ç–æ—Ä, –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –æ–ø–∏—Å–∞–Ω–∏–µ, –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –º–∞–≥–∞–∑–∏–Ω—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–Ω–∏–≥–µ

**URL:** `/books/book/create/`

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –í views.py
def book_create(request):
    if request.method == 'POST':
        form = BookForm(request.POST)
        if form.is_valid():
            book = form.save()
            messages.success(request, f'–ö–Ω–∏–≥–∞ "{book.title}" —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!')
            return redirect('books:book_detail', pk=book.pk)
    else:
        form = BookForm()
    return render(request, 'books/book_create.html', {'form': form})
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤ (ManyToMany)
- –í—ã–±–æ—Ä –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö (ForeignKey)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

#### 2.1.2. Read (–ß—Ç–µ–Ω–∏–µ)

**–§—É–Ω–∫—Ü–∏–∏:**
- `book_list(request)` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–Ω–∏–≥
- `book_detail(request, pk)` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–µ

**–û–ø–∏—Å–∞–Ω–∏–µ `book_list`:**
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–Ω–∏–≥ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π (10 –∫–Ω–∏–≥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é:
  - –ü–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É
  - –ü–æ –≥–æ–¥—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
  - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞–≤—Ç–æ—Ä—É
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É:
  - –ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–ê-–Ø, –Ø-–ê)
  - –ü–æ –∞–≤—Ç–æ—Ä—É (–ê-–Ø, –Ø-–ê)
  - –ü–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–Ω–æ–≤—ã–µ/—Å—Ç–∞—Ä—ã–µ)

**URL:** `/books/`

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π:**
```python
# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É
books = Book.objects.filter(publisher_id=publisher_id)

# –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞–≤—Ç–æ—Ä—É
books = books.filter(
    Q(title__icontains=search_query) | Q(author__icontains=search_query)
)

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
books = books.order_by('-published_date')
```

**–û–ø–∏—Å–∞–Ω–∏–µ `book_detail`:**
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω–æ–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤, –≥–¥–µ –ø—Ä–æ–¥–∞–µ—Ç—Å—è –∫–Ω–∏–≥–∞
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ –æ—Ç–∑—ã–≤—ã –Ω–∞ –∫–Ω–∏–≥—É
- –í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É –∫–Ω–∏–≥–∏

**URL:** `/books/book/<id>/`

**–ü—Ä–∏–º–µ—Ä –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–∏:**
```python
avg_rating = book.reviews.aggregate(Avg('rating'))['rating__avg']
reviews_count = book.reviews.count()
```

#### 2.1.3. Update (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ)

**–§—É–Ω–∫—Ü–∏—è:** `book_update(request, pk)`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø–æ–ª—è –∫–Ω–∏–≥–∏
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**URL:** `/books/book/<id>/update/`

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
def book_update(request, pk):
    book = get_object_or_404(Book, pk=pk)
    if request.method == 'POST':
        form = BookForm(request.POST, instance=book)
        if form.is_valid():
            book = form.save()
            messages.success(request, f'–ö–Ω–∏–≥–∞ "{book.title}" —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!')
            return redirect('books:book_detail', pk=book.pk)
    else:
        form = BookForm(instance=book)
    return render(request, 'books/book_update.html', {'form': form, 'book': book})
```

#### 2.1.4. Delete (–£–¥–∞–ª–µ–Ω–∏–µ)

**–§—É–Ω–∫—Ü–∏—è:** `book_delete(request, pk)`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –∫–∞—Å–∫–∞–¥–Ω–æ–º —É–¥–∞–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
- –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª—è–µ—Ç –∫–Ω–∏–≥—É –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã

**URL:** `/books/book/<id>/delete/`

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
def book_delete(request, pk):
    book = get_object_or_404(Book, pk=pk)
    if request.method == 'POST':
        title = book.title
        book.delete()  # –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ (on_delete=models.CASCADE)
        messages.success(request, f'–ö–Ω–∏–≥–∞ "{title}" —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞!')
        return redirect('books:book_list')
    return render(request, 'books/book_delete.html', {'book': book})
```

---

### 2.2. CRUD –¥–ª—è –º–æ–¥–µ–ª–∏ Publisher (–ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞)

#### 2.2.1. Create

**–§—É–Ω–∫—Ü–∏—è:** `publisher_create(request)`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –§–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞
- –ü–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Å—Ç—Ä–∞–Ω–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –Ω–∞–∑–≤–∞–Ω–∏—è (2 —Å–∏–º–≤–æ–ª–∞)

**URL:** `/books/publisher/create/`

#### 2.2.2. Read

**–§—É–Ω–∫—Ü–∏–∏:**
- `publisher_list(request)` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–Ω–∏–≥
- `publisher_detail(request, pk)` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å —Å–ø–∏—Å–∫–æ–º –∫–Ω–∏–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `annotate()` –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–∏–≥
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–∏ –∫–Ω–∏–≥ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞

**–ü—Ä–∏–º–µ—Ä:**
```python
publishers = Publisher.objects.annotate(
    books_count=Count('books')
).order_by('name')
```

#### 2.2.3. Update

**–§—É–Ω–∫—Ü–∏—è:** `publisher_update(request, pk)`

**URL:** `/books/publisher/<id>/update/`

#### 2.2.4. Delete

**–§—É–Ω–∫—Ü–∏—è:** `publisher_delete(request, pk)`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∫–∞—Å–∫–∞–¥–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ (CASCADE)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è—Ö —É–¥–∞–ª–µ–Ω–∏—è

**URL:** `/books/publisher/<id>/delete/`

---

### 2.3. CRUD –¥–ª—è –º–æ–¥–µ–ª–∏ Store (–ú–∞–≥–∞–∑–∏–Ω—ã)

#### 2.3.1. Create

**–§—É–Ω–∫—Ü–∏—è:** `store_create(request)`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –§–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
- –ü–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ, –≥–æ—Ä–æ–¥

**URL:** `/books/store/create/`

#### 2.3.2. Read

**–§—É–Ω–∫—Ü–∏–∏:**
- `store_list(request)` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–Ω–∏–≥
- `store_detail(request, pk)` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å —Å–ø–∏—Å–∫–æ–º –∫–Ω–∏–≥

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ—Ä–æ–¥—É
- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –º–∞–≥–∞–∑–∏–Ω–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `annotate()` –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–∏–≥

**–ü—Ä–∏–º–µ—Ä:**
```python
stores = Store.objects.annotate(
    books_count=Count('books')
).order_by('city', 'name')
```

#### 2.3.3. Update

**–§—É–Ω–∫—Ü–∏—è:** `store_update(request, pk)`

**URL:** `/books/store/<id>/update/`

#### 2.3.4. Delete

**–§—É–Ω–∫—Ü–∏—è:** `store_delete(request, pk)`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ —É–¥–∞–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–≤—è–∑–∏ ManyToMany —Å –∫–Ω–∏–≥–∞–º–∏
- –°–∞–º–∏ –∫–Ω–∏–≥–∏ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è

**URL:** `/books/store/<id>/delete/`

---

### 2.4. CRUD –¥–ª—è –º–æ–¥–µ–ª–∏ Review (–û—Ç–∑—ã–≤—ã)

#### 2.4.1. Create

**–§—É–Ω–∫—Ü–∏—è:** `review_create(request)`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –§–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –æ—Ç–∑—ã–≤–∞
- –ü–æ–ª—è: –∫–Ω–∏–≥–∞ (ForeignKey), –æ—Ü–µ–Ω–∫–∞ (1-5), —Ç–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ü–µ–Ω–∫–∏ (–æ—Ç 1 –¥–æ 5)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞ (10 —Å–∏–º–≤–æ–ª–æ–≤)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∫–Ω–∏–≥–∏ —á–µ—Ä–µ–∑ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä

**URL:** `/books/review/create/` –∏–ª–∏ `/books/review/create/?book=<id>`

**–ü—Ä–∏–º–µ—Ä:**
```python
def review_create(request):
    if request.method == 'POST':
        form = ReviewForm(request.POST)
        if form.is_valid():
            review = form.save()
            return redirect('books:review_detail', pk=review.pk)
    else:
        form = ReviewForm()
        # –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –∫–Ω–∏–≥–∏ –∏–∑ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞
        book_id = request.GET.get('book')
        if book_id:
            try:
                book = Book.objects.get(pk=book_id)
                form.fields['book'].initial = book
            except Book.DoesNotExist:
                pass
    return render(request, 'books/review_create.html', {'form': form})
```

#### 2.4.2. Read

**–§—É–Ω–∫—Ü–∏–∏:**
- `review_list(request)` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π (15 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
- `review_detail(request, pk)` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–∑—ã–≤–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ—Ü–µ–Ω–∫–µ (1-5 –∑–≤–µ–∑–¥)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–Ω–∏–≥–µ
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ –≤–∏–¥–µ –∑–≤–µ–∑–¥

**URL:** `/books/reviews/` –∏ `/books/review/<id>/`

#### 2.4.3. Update

**–§—É–Ω–∫—Ü–∏—è:** `review_update(request, pk)`

**URL:** `/books/review/<id>/update/`

#### 2.4.4. Delete

**–§—É–Ω–∫—Ü–∏—è:** `review_delete(request, pk)`

**URL:** `/books/review/<id>/delete/`

---

## 3. –û–ø–∏—Å–∞–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### 3.1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–§—É–Ω–∫—Ü–∏—è:** `analytics(request)`

**URL:** `/books/analytics/`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∫–Ω–∏–∂–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π Django ORM.

### 3.2. –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### 3.2.1. –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
total_books = Book.objects.count()
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `count()`.

#### 3.2.2. –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
total_reviews = Review.objects.count()
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –≤—Å–µ –∫–Ω–∏–≥–∏.

#### 3.2.3. –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –≤—Å–µ—Ö –∫–Ω–∏–≥

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
avg_rating_all = Review.objects.aggregate(Avg('rating'))['rating__avg'] or 0
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤ —Å –ø–æ–º–æ—â—å—é –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ `Avg()`. –ï—Å–ª–∏ –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0.

**–õ–æ–≥–∏–∫–∞:**
- `aggregate(Avg('rating'))` - –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è `rating` –≤–æ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–∞—Ö
- –†–µ–∑—É–ª—å—Ç–∞—Ç - —Å–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–æ–º `'rating__avg'`
- –ï—Å–ª–∏ –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ—Ç, `aggregate()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None`, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `or 0`

### 3.3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
publishers_stats = Publisher.objects.annotate(
    books_count=Count('books'),
    avg_rating=Avg('books__reviews__rating')
).order_by('-books_count')
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ (`books_count`)
- –°—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É –≤—Å–µ—Ö –∫–Ω–∏–≥ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (`avg_rating`)

**–õ–æ–≥–∏–∫–∞:**
- `annotate()` –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è –∫ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É Publisher
- `Count('books')` - –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ —á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å `related_name='books'`
- `Avg('books__reviews__rating')` - –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É —á–µ—Ä–µ–∑ –¥–≤–æ–π–Ω—É—é —Å–≤—è–∑—å:
  - `books` - –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∫ Book
  - `reviews` - –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∫ Review
  - `rating` - –ø–æ–ª–µ –æ—Ü–µ–Ω–∫–∏ –≤ Review
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–Ω–∏–≥ (–æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É)

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```
–ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ "–≠–∫—Å–º–æ":
- –ö–Ω–∏–≥: 15
- –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞: 4.25
```

### 3.4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
stores_stats = Store.objects.annotate(
    books_count=Count('books')
).order_by('-books_count')
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥, –∫–æ—Ç–æ—Ä—ã–µ –≤ –Ω–µ–º –ø—Ä–æ–¥–∞—é—Ç—Å—è.

**–õ–æ–≥–∏–∫–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ManyToMany —Å–≤—è–∑—å –º–µ–∂–¥—É Store –∏ Book
- `Count('books')` –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ —á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å `related_name='books'`
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–Ω–∏–≥

### 3.5. –¢–æ–ø –∫–Ω–∏–≥–∏ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
top_rated_books = Book.objects.annotate(
    avg_rating=Avg('reviews__rating'),
    reviews_count=Count('reviews')
).filter(
    reviews_count__gte=3
).order_by('-avg_rating')[:10]
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ù–∞—Ö–æ–¥–∏—Ç 10 –∫–Ω–∏–≥ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º —Å—Ä–µ–¥–∏ –∫–Ω–∏–≥, –∏–º–µ—é—â–∏—Ö –º–∏–Ω–∏–º—É–º 3 –æ—Ç–∑—ã–≤–∞.

**–õ–æ–≥–∏–∫–∞:**
- `annotate()` –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–≤–∞ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –ø–æ–ª—è:
  - `avg_rating` - —Å—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –∫–Ω–∏–≥–∏
  - `reviews_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤
- `filter(reviews_count__gte=3)` - —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∫–Ω–∏–≥–∏ —Å –º–∏–Ω–∏–º—É–º 3 –æ—Ç–∑—ã–≤–∞–º–∏ (–¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏)
- `order_by('-avg_rating')` - —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ —Å—Ä–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–µ (–æ—Ç –±–æ–ª—å—à–µ–π –∫ –º–µ–Ω—å—à–µ–π)
- `[:10]` - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç 10 –∫–Ω–∏–≥–∞–º–∏

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```
1. "–í–æ–π–Ω–∞ –∏ –º–∏—Ä" - 4.8/5 (12 –æ—Ç–∑—ã–≤–æ–≤)
2. "–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ" - 4.7/5 (8 –æ—Ç–∑—ã–≤–æ–≤)
...
```

### 3.6. –ö–Ω–∏–≥–∏ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
most_reviewed_books = Book.objects.annotate(
    reviews_count=Count('reviews'),
    avg_rating=Avg('reviews__rating')
).filter(
    reviews_count__gt=0
).order_by('-reviews_count')[:10]
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ù–∞—Ö–æ–¥–∏—Ç 10 –∫–Ω–∏–≥ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤.

**–õ–æ–≥–∏–∫–∞:**
- `annotate()` –¥–æ–±–∞–≤–ª—è–µ—Ç:
  - `reviews_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤
  - `avg_rating` - —Å—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- `filter(reviews_count__gt=0)` - –∏—Å–∫–ª—é—á–∞–µ—Ç –∫–Ω–∏–≥–∏ –±–µ–∑ –æ—Ç–∑—ã–≤–æ–≤
- `order_by('-reviews_count')` - —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Ç–∑—ã–≤–æ–≤
- `[:10]` - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç 10 –∫–Ω–∏–≥–∞–º–∏

### 3.7. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–æ–¥–∞–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
books_by_year = Book.objects.values('published_date__year').annotate(
    count=Count('id')
).order_by('-published_date__year')
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –∫–Ω–∏–≥–∏ –ø–æ –≥–æ–¥–∞–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ –≤ –∫–∞–∂–¥–æ–º –≥–æ–¥—É.

**–õ–æ–≥–∏–∫–∞:**
- `values('published_date__year')` - –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ –≥–æ–¥—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `annotate(count=Count('id'))` - –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ
- `order_by('-published_date__year')` - —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ –≥–æ–¥—É (–æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º)

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```
2023: 5 –∫–Ω–∏–≥
2022: 8 –∫–Ω–∏–≥
2021: 3 –∫–Ω–∏–≥–∏
...
```

---

## 4. –ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Django ORM

### 4.1. –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 4.1.1. Count()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π.

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
# –ü–æ–¥—Å—á–µ—Ç –≤—Å–µ—Ö –∫–Ω–∏–≥
total_books = Book.objects.count()

# –ü–æ–¥—Å—á–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ annotate
publishers = Publisher.objects.annotate(
    books_count=Count('books')
)

# –ü–æ–¥—Å—á–µ—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
reviews_count = book.reviews.count()
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
- –î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (ForeignKey, ManyToMany)
- –í –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å `annotate()` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏

#### 4.1.2. Avg()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —á–∏—Å–ª–æ–≤–æ–≥–æ –ø–æ–ª—è.

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
# –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤
avg_rating = Review.objects.aggregate(Avg('rating'))['rating__avg']

# –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏
books = Book.objects.annotate(
    avg_rating=Avg('reviews__rating')
)

# –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –∫–Ω–∏–≥ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞
publishers = Publisher.objects.annotate(
    avg_rating=Avg('books__reviews__rating')
)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –í –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å `aggregate()` –¥–ª—è –æ–±—â–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- –í –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å `annotate()` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º

#### 4.1.3. Sum(), Max(), Min()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã, –º–∞–∫—Å–∏–º—É–º–∞ –∏ –º–∏–Ω–∏–º—É–º–∞.

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
# –°—É–º–º–∞ –≤—Å–µ—Ö –æ—Ü–µ–Ω–æ–∫ (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä)
total_rating = Review.objects.aggregate(Sum('rating'))

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
max_rating = Review.objects.aggregate(Max('rating'))

# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
min_rating = Review.objects.aggregate(Min('rating'))
```

### 4.2. –ú–µ—Ç–æ–¥—ã QuerySet

#### 4.2.1. aggregate()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≥—Ä–µ–≥–∞—Ü–∏—é –ø–æ –≤—Å–µ–º—É QuerySet –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```python
result = Model.objects.aggregate(
    field_name=AggregateFunction('field')
)
```

**–ü—Ä–∏–º–µ—Ä:**
```python
# –í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤
stats = Review.objects.aggregate(
    avg_rating=Avg('rating'),
    total_count=Count('id'),
    max_rating=Max('rating')
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: {'avg_rating': 4.2, 'total_count': 50, 'max_rating': 5}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–±—â–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- –ù–µ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º

#### 4.2.2. annotate()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª—è–µ—Ç –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è –∫ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É –≤ QuerySet.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```python
objects = Model.objects.annotate(
    computed_field=AggregateFunction('related_field')
)
```

**–ü—Ä–∏–º–µ—Ä:**
```python
# –î–æ–±–∞–≤–ª—è–µ—Ç –∫ –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ –∏ —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É
books = Book.objects.annotate(
    reviews_count=Count('reviews'),
    avg_rating=Avg('reviews__rating')
)

# –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –≤—ã—á–∏—Å–ª—è–µ–º—ã–º –ø–æ–ª—è–º
for book in books:
    print(f"{book.title}: {book.reviews_count} –æ—Ç–∑—ã–≤–æ–≤, –æ—Ü–µ–Ω–∫–∞ {book.avg_rating}")
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç QuerySet —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
- –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º

**–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É aggregate() –∏ annotate():**

| –ú–µ—Ç–æ–¥ | –†–µ–∑—É–ª—å—Ç–∞—Ç | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-------|-----------|--------------|
| `aggregate()` | –û–¥–∏–Ω —Å–ª–æ–≤–∞—Ä—å | –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º—É QuerySet |
| `annotate()` | QuerySet —Å –¥–æ–ø. –ø–æ–ª—è–º–∏ | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ |

#### 4.2.3. values() —Å annotate()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∑–∞–ø–∏—Å–µ–π –ø–æ –ø–æ–ª—è–º –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã.

**–ü—Ä–∏–º–µ—Ä:**
```python
# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∫–Ω–∏–≥ –ø–æ –≥–æ–¥–∞–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
books_by_year = Book.objects.values('published_date__year').annotate(
    count=Count('id')
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```python
[
    {'published_date__year': 2023, 'count': 5},
    {'published_date__year': 2022, 'count': 8},
    ...
]
```

### 4.3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

#### 4.3.1. select_related()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è ForeignKey —Å–≤—è–∑–µ–π (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º, –æ–¥–∏–Ω –∫ –æ–¥–Ω–æ–º—É).

**–ü—Ä–∏–º–µ—Ä:**
```python
# –ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
books = Book.objects.all()
for book in books:
    print(book.publisher.name)  # –û—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏

# –° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: 1 –∑–∞–ø—Ä–æ—Å
books = Book.objects.select_related('publisher').all()
for book in books:
    print(book.publisher.name)  # –î–∞–Ω–Ω—ã–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –î–ª—è ForeignKey —Å–≤—è–∑–µ–π
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞

#### 4.3.2. prefetch_related()

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è ManyToMany –∏ –æ–±—Ä–∞—Ç–Ω—ã—Ö ForeignKey —Å–≤—è–∑–µ–π.

**–ü—Ä–∏–º–µ—Ä:**
```python
# –ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
books = Book.objects.all()
for book in books:
    for store in book.stores.all():  # –û—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏
        print(store.name)

# –° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: 2 –∑–∞–ø—Ä–æ—Å–∞ (–æ–¥–∏–Ω –¥–ª—è –∫–Ω–∏–≥, –æ–¥–∏–Ω –¥–ª—è –≤—Å–µ—Ö —Å–≤—è–∑–µ–π)
books = Book.objects.prefetch_related('stores').all()
for book in books:
    for store in book.stores.all():  # –î–∞–Ω–Ω—ã–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
        print(store.name)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –î–ª—è ManyToMany —Å–≤—è–∑–µ–π
- –î–ª—è –æ–±—Ä–∞—Ç–Ω—ã—Ö ForeignKey —Å–≤—è–∑–µ–π (related_name)
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

#### 4.3.3. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

**–ü—Ä–∏–º–µ—Ä:**
```python
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–≤—è–∑–µ–π
books = Book.objects.select_related('publisher').prefetch_related(
    'stores', 'reviews'
).all()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- 1 –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–Ω–∏–≥ –∏ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤ (select_related)
- 1 –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ (prefetch_related)
- 1 –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤ (prefetch_related)
- –ò—Ç–æ–≥–æ: 3 –∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ N+1

---

## 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### 5.1. –ü—Ä–æ–±–ª–µ–º–∞ N+1 –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —Å–≤—è–∑–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º Django –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:**
```python
# –ü–ª–æ—Ö–æ: N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
books = Book.objects.all()  # 1 –∑–∞–ø—Ä–æ—Å
for book in books:  # N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤
    print(book.publisher.name)
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –•–æ—Ä–æ—à–æ: 1 –∑–∞–ø—Ä–æ—Å
books = Book.objects.select_related('publisher').all()  # 1 –∑–∞–ø—Ä–æ—Å
for book in books:  # –î–∞–Ω–Ω—ã–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
    print(book.publisher.name)
```

### 5.2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ

#### 5.2.1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è book_list

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
books = Book.objects.select_related('publisher').prefetch_related(
    'stores', 'reviews'
).all()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: 1 + N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤ + N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–æ–≤ + N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤
- –° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: 3 –∑–∞–ø—Ä–æ—Å–∞ (–∫–Ω–∏–≥–∏+–∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –º–∞–≥–∞–∑–∏–Ω—ã, –æ—Ç–∑—ã–≤—ã)

#### 5.2.2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è book_detail

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
book = get_object_or_404(
    Book.objects.select_related('publisher').prefetch_related(
        'stores', 'reviews'
    ),
    pk=pk
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –í—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞ 3 –∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

#### 5.2.3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è publisher_detail

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
publisher = get_object_or_404(
    Publisher.objects.prefetch_related('books__reviews'),
    pk=pk
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –≤—Å–µ –µ–≥–æ –∫–Ω–∏–≥–∏ –∏ –≤—Å–µ –æ—Ç–∑—ã–≤—ã –Ω–∞ —ç—Ç–∏ –∫–Ω–∏–≥–∏ –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤

### 5.3. –ò–∑–º–µ—Ä–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```
–ó–∞–ø—Ä–æ—Å 1: SELECT * FROM books_book;
–ó–∞–ø—Ä–æ—Å 2: SELECT * FROM books_publisher WHERE id=1;
–ó–∞–ø—Ä–æ—Å 3: SELECT * FROM books_publisher WHERE id=2;
...
–ó–∞–ø—Ä–æ—Å N+1: SELECT * FROM books_publisher WHERE id=N;
```

**–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π:**
```
–ó–∞–ø—Ä–æ—Å 1: SELECT * FROM books_book JOIN books_publisher ON ...;
–ó–∞–ø—Ä–æ—Å 2: SELECT * FROM books_store WHERE id IN (...);
–ó–∞–ø—Ä–æ—Å 3: SELECT * FROM books_review WHERE book_id IN (...);
```

**–í—ã–∏–≥—Ä—ã—à:** –° N+1 –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ 3 –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–∏–≥.

---

## 6. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### 6.1. –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
books/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ admin.py              # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
‚îú‚îÄ‚îÄ apps.py
‚îú‚îÄ‚îÄ forms.py              # ‚ú® –ù–û–í–´–ô: –§–æ—Ä–º—ã –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ models.py             # –ú–æ–¥–µ–ª–∏ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
‚îú‚îÄ‚îÄ queries.py            # ORM –∑–∞–ø—Ä–æ—Å—ã (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
‚îú‚îÄ‚îÄ urls.py               # ‚ú® –ù–û–í–´–ô: URL –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ views.py              # ‚ú® –ù–û–í–´–ô: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
‚îú‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
‚îî‚îÄ‚îÄ README_CRUD.md        # ‚ú® –ù–û–í–´–ô: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ CRUD

templates/
‚îî‚îÄ‚îÄ books/                # ‚ú® –ù–û–í–´–ô: –®–∞–±–ª–æ–Ω—ã –¥–ª—è books
    ‚îú‚îÄ‚îÄ base.html         # –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω
    ‚îú‚îÄ‚îÄ book_list.html
    ‚îú‚îÄ‚îÄ book_detail.html
    ‚îú‚îÄ‚îÄ book_create.html
    ‚îú‚îÄ‚îÄ book_update.html
    ‚îú‚îÄ‚îÄ book_delete.html
    ‚îú‚îÄ‚îÄ publisher_list.html
    ‚îú‚îÄ‚îÄ publisher_detail.html
    ‚îú‚îÄ‚îÄ publisher_create.html
    ‚îú‚îÄ‚îÄ publisher_update.html
    ‚îú‚îÄ‚îÄ publisher_delete.html
    ‚îú‚îÄ‚îÄ store_list.html
    ‚îú‚îÄ‚îÄ store_detail.html
    ‚îú‚îÄ‚îÄ store_create.html
    ‚îú‚îÄ‚îÄ store_update.html
    ‚îú‚îÄ‚îÄ store_delete.html
    ‚îú‚îÄ‚îÄ review_list.html
    ‚îú‚îÄ‚îÄ review_detail.html
    ‚îú‚îÄ‚îÄ review_create.html
    ‚îú‚îÄ‚îÄ review_update.html
    ‚îú‚îÄ‚îÄ review_delete.html
    ‚îî‚îÄ‚îÄ analytics.html    # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

static/
‚îî‚îÄ‚îÄ books/                # ‚ú® –ù–û–í–´–ô: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    ‚îî‚îÄ‚îÄ css/
        ‚îî‚îÄ‚îÄ styles.css    # –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è books

myshop/
‚îî‚îÄ‚îÄ urls.py               # ‚ú® –û–ë–ù–û–í–õ–ï–ù: –î–æ–±–∞–≤–ª–µ–Ω include –¥–ª—è books.urls
```

### 6.2. URL —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–í—Å–µ URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è books –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É `/books/`:

```
/books/                           ‚Üí –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥
/books/book/<id>/                 ‚Üí –î–µ—Ç–∞–ª–∏ –∫–Ω–∏–≥–∏
/books/book/create/                ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–∏–≥–∏
/books/book/<id>/update/          ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏
/books/book/<id>/delete/          ‚Üí –£–¥–∞–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏

/books/publishers/                 ‚Üí –°–ø–∏—Å–æ–∫ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤
/books/publisher/<id>/             ‚Üí –î–µ—Ç–∞–ª–∏ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞
/books/publisher/create/           ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞
/books/publisher/<id>/update/      ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞
/books/publisher/<id>/delete/     ‚Üí –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞

/books/stores/                     ‚Üí –°–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤
/books/store/<id>/                 ‚Üí –î–µ—Ç–∞–ª–∏ –º–∞–≥–∞–∑–∏–Ω–∞
/books/store/create/               ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
/books/store/<id>/update/         ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
/books/store/<id>/delete/         ‚Üí –£–¥–∞–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞

/books/reviews/                    ‚Üí –°–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤
/books/review/<id>/                ‚Üí –î–µ—Ç–∞–ª–∏ –æ—Ç–∑—ã–≤–∞
/books/review/create/              ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞
/books/review/<id>/update/         ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞
/books/review/<id>/delete/        ‚Üí –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞

/books/analytics/                  ‚Üí –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
```

---

## 7. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### 7.1. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   ```bash
   python manage.py runserver
   ```

2. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
   - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–Ω–∏–≥: http://127.0.0.1:8000/books/
   - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: http://127.0.0.1:8000/books/analytics/

### 7.2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://127.0.0.1:8000/books/
2. –ù–∞–∂–º–∏—Ç–µ "‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ
4. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–æ–∑–¥–∞–π—Ç–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –º–∞–≥–∞–∑–∏–Ω—ã –∏ –æ—Ç–∑—ã–≤—ã

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://127.0.0.1:8000/admin/
2. –°–æ–∑–¥–∞–π—Ç–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –º–∞–≥–∞–∑–∏–Ω—ã, –∫–Ω–∏–≥–∏ –∏ –æ—Ç–∑—ã–≤—ã

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Django shell

```python
python manage.py shell

from books.models import Publisher, Store, Book, Review
from datetime import date

# –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞
publisher = Publisher.objects.create(
    name='–≠–∫—Å–º–æ',
    country='–†–æ—Å—Å–∏—è'
)

# –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
store = Store.objects.create(
    name='–ß–∏—Ç–∞–π-–≥–æ—Ä–æ–¥',
    city='–ú–æ—Å–∫–≤–∞'
)

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–∏–≥–∏
book = Book.objects.create(
    title='–í–æ–π–Ω–∞ –∏ –º–∏—Ä',
    author='–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π',
    published_date=date(1869, 1, 1),
    description='–†–æ–º–∞–Ω-—ç–ø–æ–ø–µ—è...',
    publisher=publisher
)
book.stores.add(store)

# –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞
Review.objects.create(
    book=book,
    rating=5,
    text='–û—Ç–ª–∏—á–Ω–∞—è –∫–Ω–∏–≥–∞!'
)
```

### 7.3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π

#### –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–∏–≥–∏:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://127.0.0.1:8000/books/book/create/
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - –ù–∞–∑–≤–∞–Ω–∏–µ: "–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ"
   - –ê–≤—Ç–æ—Ä: "–§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π"
   - –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: 1866-01-01
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–†–æ–º–∞–Ω –æ..."
   - –ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ: –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞
   - –ú–∞–≥–∞–∑–∏–Ω—ã: –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ
3. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–Ω–∏–≥–∞ –ø–æ—è–≤–∏–ª–∞—Å—å –≤ —Å–ø–∏—Å–∫–µ

#### –¢–µ—Å—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±—É—é –∫–Ω–∏–≥—É –∏–∑ —Å–ø–∏—Å–∫–∞
2. –ù–∞–∂–º–∏—Ç–µ "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
3. –ò–∑–º–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ
4. –ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å"
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±—É—é –∫–Ω–∏–≥—É
2. –ù–∞–∂–º–∏—Ç–µ "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å"
3. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ "–î–∞, —É–¥–∞–ª–∏—Ç—å"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–Ω–∏–≥–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞

#### –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

1. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–ø–∏—Å–∫–∞ –∫–Ω–∏–≥ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã:
   - –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
   - –í–≤–µ–¥–∏—Ç–µ –≥–æ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞–≤—Ç–æ—Ä—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

#### –¢–µ—Å—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://127.0.0.1:8000/books/analytics/
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
   - –û–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º
   - –¢–æ–ø –∫–Ω–∏–≥ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
   - –ö–Ω–∏–≥ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –≥–æ–¥–∞–º

### 7.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Django Debug Toolbar –∏–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```python
from django.db import connection

# –í –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏
def book_list(request):
    books = Book.objects.select_related('publisher').prefetch_related(
        'stores', 'reviews'
    ).all()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
    print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤: {len(connection.queries)}")
    
    return render(request, 'books/book_list.html', {'books': books})
```

---

## 8. –í—ã–≤–æ–¥—ã

### 8.1. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

‚úÖ **CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—ã
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–æ–≤ –∏ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
- –£–¥–∞–ª–µ–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º

‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:**
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–æ–ª—è–º
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª—è–º
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º

‚úÖ **–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ select_related()
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ prefetch_related()
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
- –£–¥–æ–±–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### 8.2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Django ORM

- **–ú–µ—Ç–æ–¥—ã QuerySet:** `filter()`, `exclude()`, `order_by()`, `values()`
- **–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:** `Count()`, `Avg()`, `Sum()`, `Max()`, `Min()`
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** `select_related()`, `prefetch_related()`
- **–ê–≥—Ä–µ–≥–∞—Ü–∏—è:** `aggregate()`, `annotate()`
- **–°–≤—è–∑–∏:** ForeignKey, ManyToMany, –æ–±—Ä–∞—Ç–Ω—ã–µ —Å–≤—è–∑–∏ (related_name)

### 8.3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–Ω–∏–∂–Ω—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º —Å:
- –ü–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º CRUD –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –£–¥–æ–±–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏.

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-27  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

